// Copyright (c) .NET Foundation. All rights reserved.
// Licensed under the Apache License, Version 2.0. See License.txt in the project root for license information.

using System.Threading;
using System.Threading.Tasks;

namespace UpdateVulnerabilityData.CWE
{
    /// <summary>
    /// Utility to download and save the latest CWE data to disk.
    /// </summary>
    public interface ICweDataDownloader
    {
        /// <summary>
        /// Downloads the latest CWE data for the 'Development Concepts' view in compressed CSV-format,
        /// and extracts it to the <paramref name="targetFilePath"/>.
        /// </summary>
        /// <param name="targetFilePath">The destination file path to save the downloaded CSV file to.</param>
        /// <param name="cancellationToken">The <see cref="CancellationToken"/>.</param>
        /// <returns>Returns a <see cref="FileDownloadResult"/> providing information about the extracted JSON-formatted CWE data.</returns>
        Task<FileDownloadResult> DownloadAndExtractCsvDataToDiskAsync(string targetFilePath, CancellationToken cancellationToken);
    }
}