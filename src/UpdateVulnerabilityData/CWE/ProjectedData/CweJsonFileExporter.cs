// Copyright (c) .NET Foundation. All rights reserved.
// Licensed under the Apache License, Version 2.0. See License.txt in the project root for license information.

using System;
using Newtonsoft.Json;

namespace UpdateVulnerabilityData.CWE
{
    /// <summary>
    /// Generates a JSON-file containing a projection of the provided CSV source data.
    /// </summary>
    public static class CweJsonFileExporter
    {
        /// <summary>
        /// Projects the provided CWE data from CSV-format to JSON.
        /// </summary>
        /// <param name="csvDocument">The CSV-document containing CWE source data.</param>
        /// <returns>A JSON-formatted string.</returns>
        public static string RenderJson(CweCsvDocument csvDocument)
        {
            var cweJsonDocument = new CweJsonDocument();

            foreach (var entry in csvDocument.Entries)
            {
                var item = new CweJsonDocumentEntry();
                item.Id = "CWE-" + entry.CweId;
                item.Description = entry.Description.RemoveSurroundingQuotes();
                item.Name = entry.Name;
                item.Status = entry.Status;

                cweJsonDocument.Items.Add(item);
            }

            return JsonConvert.SerializeObject(cweJsonDocument, Formatting.None);
        }
    }
}
