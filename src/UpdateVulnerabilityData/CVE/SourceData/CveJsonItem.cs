// Copyright (c) .NET Foundation. All rights reserved.
// Licensed under the Apache License, Version 2.0. See License.txt in the project root for license information.

using System;
using Newtonsoft.Json;

namespace UpdateVulnerabilityData.CVE
{
    public class CveJsonItem
    {
        [JsonProperty(PropertyName = "cve")]
        public CveJsonObject Cve { get; set; }

        [JsonProperty(PropertyName = "publishedDate")]
        public DateTime Published { get; set; }

        [JsonProperty(PropertyName = "lastModifiedDate")]
        public DateTime LastModified { get; set; }

        [JsonProperty(PropertyName = "impact")]
        public CveImpactJsonObject Impact { get; set; }

        public decimal? GetCvssRating()
        {
            if (Impact == null)
            {
                return null;
            }
            else if (Impact.BaseMetricV3 != null)
            {
                // Prefer v3 metric if available.
                return Impact.BaseMetricV3.CvssV3?.BaseScore;
            }
            else if (Impact.BaseMetricV2 != null)
            {
                return Impact.BaseMetricV2.CvssV2?.BaseScore;
            }

            return null;
        }
    }
}