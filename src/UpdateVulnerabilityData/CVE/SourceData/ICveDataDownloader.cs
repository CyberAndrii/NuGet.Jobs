// Copyright (c) .NET Foundation. All rights reserved.
// Licensed under the Apache License, Version 2.0. See License.txt in the project root for license information.

using System.Threading.Tasks;

namespace UpdateVulnerabilityData.CVE
{
    /// <summary>
    /// Utility to download and save the latest CVE data to disk.
    /// </summary>
    public interface ICveDataDownloader
    {
        /// <summary>
        /// Downloads a compressed ZIP archive containing the JSON-formatted CVE data for the specified <paramref name="year"/>.
        /// </summary>
        /// <param name="year">The year for which to download the CVE data.</param>
        /// <param name="targetFilePath">The target file path.</param>
        /// <param name="expectedZipFileSize">The expected ZIP-file size in bytes.</param>
        /// <returns>Returns a <see cref="CveFileDownloadResult"/> providing information about the extracted JSON-formatted CVE data.</returns>
        Task<CveFileDownloadResult> DownloadAndExtractJsonDataToDiskAsync(
            int year, 
            string targetFilePath, 
            long expectedZipFileSize);

        /// <summary>
        /// Downloads the compressed ZIP archive containing the JSON-formatted CVE data from the MODIFIED feed.
        /// </summary>
        /// <param name="targetFilePath">The target file path.</param>
        /// <param name="expectedZipFileSize">The expected ZIP-file size in bytes.</param>
        /// <returns>Returns a <see cref="CveFileDownloadResult"/> providing information about the extracted JSON-formatted CVE data.</returns>
        Task<CveFileDownloadResult> DownloadAndExtractModifiedDataToDisk(
            string targetFilePath,
            long expectedZipFileSize);

        /// <summary>
        /// Downloads a text file containing CVE META information for the specified <paramref name="year"/>.
        /// </summary>
        /// <param name="year">The year for which to download the CVE data.</param>
        /// <param name="targetFilePath">The target file path.</param>
        /// <returns>Returns a <see cref="CveMetaFileDownloadResult"/> providing information about the CVE META file.</returns>
        Task<CveMetaFileDownloadResult> DownloadAndParseSourceMetaFileAsync(int year, string targetFilePath);

        /// <summary>
        /// Downloads a text file containing CVE META information for the MODIFIED feed.
        /// </summary>
        /// <param name="targetFilePath">The target file path.</param>
        /// <returns>Returns a <see cref="CveMetaFileDownloadResult"/> providing information about the CVE META file.</returns>
        Task<CveMetaFileDownloadResult> DownloadAndParseModifiedMetaFileAsync(string targetFilePath);
    }
}