// Copyright (c) .NET Foundation. All rights reserved.
// Licensed under the Apache License, Version 2.0. See License.txt in the project root for license information.

using System.Threading;
using System.Threading.Tasks;

namespace UpdateVulnerabilityData.CVE
{
    /// <summary>
    /// Utility to download and save the latest CVE data to disk.
    /// </summary>
    public interface ICVEDataDownloader
    {
        /// <summary>
        /// Downloads a compressed ZIP archive containing the JSON-formatted CVE data for the specified <paramref name="year"/>.
        /// </summary>
        /// <param name="year">The year for which to download the CVE data.</param>
        /// <returns>Returns the file path to the extracted JSON-formatted CVE data.</returns>
        Task<string> DownloadAndExtractJsonDataToDiskAsync(int year, string targetFile, CancellationToken cancellationToken);
    }
}