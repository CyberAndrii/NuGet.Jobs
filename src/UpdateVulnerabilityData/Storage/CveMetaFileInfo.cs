// Copyright (c) .NET Foundation. All rights reserved.
// Licensed under the Apache License, Version 2.0. See License.txt in the project root for license information.

using System;
using System.Diagnostics;
using UpdateVulnerabilityData.CVE;

namespace UpdateVulnerabilityData.Storage
{
    /// <summary>
    /// JSON-(de)serializable representation of CVE .META file contents,
    /// and file metadata.
    /// </summary>
    [DebuggerDisplay("Meta file name: {MetaFileName}")]
    public class CveMetaFileInfo
    {
        /// <summary>
        /// Last modified date of the CVE data for this <see cref="Year"/>.
        /// </summary>
        public DateTime LastModifiedDate { get; set; }

        /// <summary>
        /// The file size in bytes of the JSON file containing CVE data for this <see cref="Year"/>.
        /// </summary>
        public long JsonFileSize { get; set; }

        /// <summary>
        /// The file size in bytes of the ZIP archive.
        /// </summary>
        public long ZipFileSize { get; set; }

        /// <summary>
        /// The SHA-256 hash of the JSON file.
        /// </summary>
        public string JsonFileSha256 { get; set; }

        /// <summary>
        /// The file name of the .META file for this <see cref="Year"/>.
        /// </summary>
        public string MetaFileName { get; set; }

        /// <summary>
        /// The file name of the .JSON file for this <see cref="Year"/>.
        /// </summary>
        public string JsonFileName { get; set; }

        /// <summary>
        /// The file name of the .ZIP archive for this <see cref="Year"/>.
        /// </summary>
        public string ZipArchiveFileName { get; set; }

        /// <summary>
        /// The year for which the files contain CVE data.
        /// </summary>
        /// <remarks>
        /// A value of <see cref="CveConstants.InitialCveYear"/> means: all CVE data for that year and older.
        /// A value of <c>null</c> means: the MODIFIED CVE data file.
        /// </remarks>
        public int? Year { get; set; }
    }
}